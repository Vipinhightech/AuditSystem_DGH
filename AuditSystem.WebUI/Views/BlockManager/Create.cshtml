@model AuditSystem.Core.ViewModels.AuditBlocksViewModel
@{
    ViewBag.Title = "Create";
}

@*<h2>Create</h2>*@


@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

<div class="form-horizontal">
    <h4>Add Block</h4>
    <hr />
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })

    <table class="table">
        <tbody>
            <tr style="border-style:hidden;">
                <td style="width:15%"> @Html.LabelFor(model => model.Block.Block_Id, htmlAttributes: new { @class = "control-label col-md-2" })</td>
                <td style="width:35%">
                    @Html.DropDownListFor(model => model.Block.Block_Id, new SelectList(Model.wS_Blocks, "Block_Id", "Block_Name"), new { htmlAttributes = new { @class = "form-control" } })
                </td>

                <td style="width:15%">  @Html.LabelFor(model => model.Block.Block_Current_Status, htmlAttributes: new { @class = "control-label col-md-2" })</td>
                <td style="width:35%">
                    @Html.DropDownListFor(model => model.Block.Block_Current_Status, new List<SelectListItem> {
                        new SelectListItem {Text = "Exploration",Value =  "Exploration" },
                        new SelectListItem {Text = "Development",Value =  "Development" },
                        new SelectListItem {Text = "Production",Value =  "Production" }
                    })
                </td>
            </tr>

            <tr style="border-style:hidden;">
                <td style="width:15%"> @Html.LabelFor(model => model.Block.Block_Category, htmlAttributes: new { @class = "control-label col-md-2" })</td>
                <td style="width:35%"> @Html.DropDownListFor(model => model.Block.Block_Category, new SelectList(Enumerable.Range(1, 4)))</td>

                <td style="width:15%">  @Html.LabelFor(model => model.Block.Revenue_Till_Date, htmlAttributes: new { @class = "control-label col-md-2" }) </td>
                <td style="width:35%">
                    @Html.EditorFor(model => model.Block.Revenue_Till_Date, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.Block.Revenue_Till_Date, "", new { @class = "text-danger" })
                </td>
            </tr>

            <tr style="border-style:hidden;">
                <td style="width:15%"> @Html.LabelFor(model => model.Block.Expenditure_Till_Date, htmlAttributes: new { @class = "control-label col-md-2" })</td>
                <td style="width:35%">
                    @Html.EditorFor(model => model.Block.Expenditure_Till_Date, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.Block.Expenditure_Till_Date, "", new { @class = "text-danger" })
                </td>

                <td style="width:15%"> @Html.LabelFor(model => model.Block.Updated_Status_Year, htmlAttributes: new { @class = "control-label col-md-2" })</td>
                <td style="width:35%">
                    @Html.DropDownListFor(model => model.Block.Updated_Status_Year, new List<SelectListItem> {
                        new SelectListItem {Text = "2020-2021",Value =  "2020-2021" },
                        new SelectListItem {Text = "2021-2022",Value =  "2021-2022" },
                        new SelectListItem {Text = "2022-2023",Value =  "2022-2023" },
                        new SelectListItem {Text = "2023-2024",Value =  "2023-2024" },
                        new SelectListItem {Text = "2024-2025",Value =  "2024-2025" }
                    })
                </td>
            </tr>

        </tbody>

    </table>







    <hr />
    <div class="form-group">
        <h5>Yearwise Revenue and Expenditure </h5> <br/>
        <div class="col-md-10">
            <table id="RevExpTable" class="table">
                <thead>
                    <tr>
                        <th>Year</th>
                        <th>Revenue</th>
                        <th>Expenditure</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    @for (int i = 0; i < Model.Block.Revenue_Expenditures.Count; i++)
                    {
                        <tr>
                            <td>
                               
                                @Html.DropDownListFor(model => model.Block.Revenue_Expenditures[i].Year, new List<SelectListItem> {
                                     new SelectListItem {Text = "2020-2021",Value =  "2020-2021" },
                                     new SelectListItem {Text = "2021-2022",Value =  "2021-2022" },
                                     new SelectListItem {Text = "2022-2023",Value =  "2022-2023" },
                                     new SelectListItem {Text = "2023-2024",Value =  "2023-2024" },
                                     new SelectListItem {Text = "2024-2025",Value =  "2024-2025" }
                                 })
                            </td>

                            <td>
                                @Html.EditorFor(model => model.Block.Revenue_Expenditures[i].Revenue, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.Block.Revenue_Expenditures[i].Revenue, "", new { @class = "text-danger" })
                            </td>

                            <td>
                                @Html.EditorFor(model => model.Block.Revenue_Expenditures[i].Expenditure, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.Block.Revenue_Expenditures[i].Expenditure, "", new { @class = "text-danger" })
                            </td>

                            <td>
                                <button type="button" class="btn btn-danger" onclick="removeRow(this)">Remove</button>
                            </td>
                        </tr>

                    }
                </tbody>
            </table>
            <button style="float:right" type="button" class="btn btn-primary" onclick="addRow()">Add Row</button>

        </div>
    </div>


    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <br />
            <input type="submit" value="Save" class="btn btn-primary" />
        </div>
    </div>
</div>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script type="text/javascript">
        function addRow() {
            var table = document.getElementById('RevExpTable').getElementsByTagName('tbody')[0];
            var newRow = table.insertRow();
            var rowCount = table.rows.length - 1;
          
            newRow.innerHTML = `
               <td>   <select name="Block.Revenue_Expenditures[${rowCount}].Year" >
            <option value="2020-2021">2020-2021</option>
            <option value="2021-2022">2021-2022</option>
            <option value="2022-2023">2022-2023</option>
            <option value="2023-2024">2023-2024</option>
            <option value="2024-2025">2024-2025</option>
        </select></td>
                <td><input type="text" name="Block.Revenue_Expenditures[${rowCount}].Revenue" class="form-control" /></td>
                <td><input type="text" name="Block.Revenue_Expenditures[${rowCount}].Expenditure" class="form-control" /></td>
                
                <td><button type="btn btn-danger" onclick="removeRow(this)">Remove</button></td>
            `;
        }

        function removeRow(button) {
            var row = button.closest('tr');
            row.parentNode.removeChild(row);
        }
    </script>
}

